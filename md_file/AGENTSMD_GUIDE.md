⸻

🧭 Codex大規模開発レポート：AGENTS.md と Plans.md の運用設計

1. 背景：AIエージェント時代の開発スタイル

OpenAI内部のCodex開発チームでは、AIエージェントをチームメイトとして扱う発想が定着している。
つまり、人間とAIが「ペアプログラミング」や「長時間の共同開発」を行い、AIが設計、実装、テスト、レビューの各フェーズを継続的に引き継ぐ。

そのためには、人間の文脈とAIの文脈の両方が一貫して追跡可能な構造が必要になる。
この要件を満たすために生まれたのが、2つのメタドキュメント：
	•	AGENTS.md：AIエージェント（Codexなど）への役割と行動規範を定義する
	•	Plans.md：プロジェクト単位での計画・進行・意思決定ログを保持する

これらは単なるメモではなく、AIが自ら参照・修正・更新する開発中枢ファイルである。

⸻

2. AGENTS.md の目的と設計思想

🧩 役割

AGENTS.mdは、チーム内のAIエージェントに「自分がどう動くべきか」を教える指令書。
	•	どんなタスクを自動で担当できるか（例：テスト生成・リファクタ・レビュー）
	•	どんな権限を持ち、どんな操作を許可されるか
	•	どんな判断を人間に委譲すべきか
	•	MCPツールやCLI統合の使い方

Codexが自律的に動くための「AI版オンボーディングマニュアル」といえる。

🧠 運用Tips
	1.	抽象ではなく具体を記述する
	•	“Code reviewを行う”ではなく、“/reviewコマンド実行時にmainブランチとの差分を比較してP1/P0レベルの指摘を出す”といった具合に。
	2.	対話スタイルを定義する
	•	例：

Codexは建設的に批判する。冗長な賛辞は不要。提案は具体例とともに出す。


	3.	スレッド構造を分離する
	•	レビュー、実装、テストなどの文脈を別スレッド化するよう指示することで、バイアスを軽減。
	4.	共通タスク構文を明文化
	•	/plan /implement /review /test /fix などのコマンドスタイルを揃えることで再現性が高まる。

⸻

3. Plans.md の目的と設計思想

🗂 概要

Plans.mdは、プロジェクトの「生きた設計書」。
仕様、進捗、意思決定、ToDo、驚きや発見までも全て記録される。

“設計ドキュメントの設計ドキュメント”
— Codexチームエンジニア Fel の言葉

📜 構造の原則
	1.	トップに大局説明（目的・最終状態）
	•	この文脈があることで、Codexが“ゴールを誤認しない”。
	2.	「実行計画（Execution Plan）」の用語を固定
	•	“execution plan”というキーワードを明確に使うことで、Codexが正確にPlans.mdを参照できる。
	3.	進捗とToDoを明示
	•	- [x] 完了 / - [ ] 未完了 の形式を維持。
Codexがチェックリストとして扱えるようにする。
	4.	驚き・発見・判断理由を記録
	•	人間では「雑談」扱いになるメモも、AIには重要な“推論データ”となる。
	5.	決定ログ（Decision Log）を残す
	•	“なぜこの設計を選んだのか”を常に記録。これが後の自動レビューや回帰防止の鍵になる。

🧰 運用Tips
	•	Codexに「/plan」を投げてPlans.md更新を指示 → Codexが自動的に反映。
	•	すべての大規模機能には1つのPlans.mdを割り当て、Codexが自走的に更新。
	•	テスト・結果・修正後の反省までをPlans.md内で完結させる。

⸻

4. 運用ワークフロー例（Codex + Cursor 環境）
	1.	初期設計
	•	人間が概要を記述。
	•	Codexに /plan コマンドを発行 → 設計書生成。
	•	Plans.mdに実行計画が作成される。
	2.	実装フェーズ
	•	Codexが Plans.md に従って実行。
	•	コードを生成・検証・修正を自動で繰り返す。
	•	スナップショットやUIプレビューを生成して視覚的に検証。
	3.	レビュー
	•	/review コマンドでGitHub差分を解析。
	•	P0/P1レベルの問題のみを抽出し、ノイズを削減。
	•	修正後に再レビューを自動実行。
	4.	履歴更新
	•	CodexがPlans.md内の進捗や学びを追記。
	•	“Decision Log” に「設計変更理由」や「次回の課題」を記録。

⸻

5. 長時間実行・大規模開発のベストプラクティス
	•	Codexは長時間タスクを扱える（最大7時間/1.5億トークン）
→ プロジェクトを中断せず、Plans.mdによって文脈を保持可能。
	•	Codexを複数ターミナルで並列稼働
→ “10倍エンジニア”戦略。各ターミナルが別フェーズの仕事を担当。
	•	自動コンテキスト圧縮 + MCP統合
→ 複数プロジェクト間の依存関係を維持しながら長期記憶を確保。
	•	クラウドタスク + スクリーンショット検証
→ CodexがUI/UXを視覚的にチェックできる仕組み。
	•	GitHubレビュー統合
→ すべてのPRに自動レビューを実行。修正・再レビューをワンラインで完結。

⸻

6. Cursor / Codex セットアップ指針

エージェント認識設定

Codex（またはCursor AI）に次のルールを明示する：

- プロジェクトごとに Plans.md を参照・更新する
- 全タスクは Plans.md の Execution Plan に基づく
- 自身の行動規範は AGENTS.md に従う
- Plans.md と AGENTS.md は常に整合性を保つ
- 長期タスク中も両ファイルを随時更新し、差分をコミット

CLI統合例

codex /plan
codex /implement
codex /review
codex /fix

GitHub設定
	•	「コードレビューをすべてのPRで有効化」
	•	Codexをレビュワーとして自動登録
	•	/reviewコマンドでローカルでも同じプロセスを実行可能に

⸻

7. 結論：AIエージェント開発の新しい標準形

AGENTS.mdとPlans.mdは、AIを単なる補助ではなくチームメイトにするための設計図。
これを導入することで、開発チームは以下を実現する：
	•	一貫した長期記憶と意思決定プロセス
	•	高速かつ正確なコードレビュー
	•	マルチエージェント協働による同時開発
	•	人間が創造的判断に集中できる開発体制

⸻
